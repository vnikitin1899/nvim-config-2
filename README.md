# Neovim Configuration

Конфигурация Neovim с использованием lazy.nvim как менеджера плагинов.

## Структура проекта

```
nvim/
├── init.lua                 # Точка входа, загружает lazy.nvim
├── lua/
│   ├── config/
│   │   ├── lazy.lua        # Настройка lazy.nvim
│   │   ├── shortcuts.lua   # Пользовательские маппинги
│   │   └── colors.lua      # Настройки цветовой схемы (включая JSDoc)
│   └── plugins/
│       ├── telescope.lua   # Конфигурация плагина Telescope
│       └── treesitter.lua  # Подсветка синтаксиса через Treesitter
└── lazy-lock.json          # Зафиксированные версии плагинов
```

## Установка

1. Убедитесь, что у вас установлен Neovim (версия 0.9+)
2. Склонируйте этот репозиторий в `~/.config/nvim/`
3. Запустите Neovim - lazy.nvim автоматически установится при первом запуске

## Плагины

### Установленные плагины

- **lazy.nvim** - Менеджер плагинов
- **telescope.nvim** (v0.2.0) - Файловый поиск и навигация
  - Зависимость: plenary.nvim
- **neo-tree.nvim** - Дерево файлов с git/diagnostics подсветкой
  - Зависимости: plenary.nvim, nui.nvim, nvim-web-devicons
- **nvim-treesitter** - Подсветка синтаксиса и парсинг кода
- **conform.nvim** - Автоматическое форматирование файлов (на сохранение и по запросу)
- **codecompanion.nvim** - AI помощник для кода
- **git-conflict.nvim** - Удобные хоткеи для разбора merge-конфликтов прямо в буфере
- **lazygit.nvim** - Быстрый вызов интерфейса LazyGit прямо из Neovim (плавающее окно по `git` / `<leader>gd`, скрытые заголовки diff через `delta`)
- **nvim-autopairs** - Автозакрытие скобок и кавычек с поддержкой Fast Wrap и интеграцией с автодополнением

### Добавление нового плагина

Создайте файл в `lua/plugins/` с именем плагина, например:

```lua
-- lua/plugins/my-plugin.lua
return {
    'author/repo',
    config = function()
        -- конфигурация плагина
    end,
    dependencies = { 'dependency/repo' }
}
```

## Настройки

### Лидер клавиш

- Глобальный лидер: `<Space>`
- Локальный лидер: `\`

### Цветовая схема

Конфигурация использует цвета терминала для максимальной совместимости. Neovim автоматически адаптируется под цветовую схему вашего терминала.

Для изменения темы терминала можно установить переменную окружения `TERM_THEME` или изменить настройки в `lua/config/colors.lua`.

### Маппинги

Пользовательские маппинги добавляются в `lua/config/shortcuts.lua`.

**Доступные маппинги:**
- `ff` - Открыть Telescope для поиска файлов
- `<leader>e` - Neo-tree: открыть/закрыть проводник слева
- `<leader>ef` - Neo-tree: подсветить текущий файл
- `<leader>ec` - Neo-tree: закрыть окно дерева
- `<leader>fx` - LSP: автоматическое применение первого доступного quickfix/исправления для текущей строки (включая добавление недостающих импортов)
- `:LspAutoImport` - LSP: добавить или упорядочить импорты в текущем файле

### Автоформатирование

Плагин `conform.nvim` автоматически форматирует буфер перед сохранением, если установлен подходящий форматтер. Дополнительно Prettier запускается при каждом `InsertLeave` для JS/TS/Markdown/CSS/HTML (JSON только вручную), чтобы код оставался выровненным ещё до сохранения. Для ручного запуска используйте `<leader>cf` (работает и в Visual режиме). Управление:
- JSON форматируется Prettier с отступом в 2 пробела, но только по ручной команде (`<leader>cf` или `:Format`).

- `:FormatDisable` / `:FormatEnable` / `:FormatToggle` — управление форматированием на сохранение (добавьте `!`, чтобы применить только к текущему буферу)
- `:FormatInsertDisable` / `:FormatInsertEnable` / `:FormatInsertToggle` — управление автозапуском Prettier при выходе из Insert (также поддерживают `!` для буфера)


### Поддерживаемые языки (Treesitter)

Конфигурация включает подсветку синтаксиса для следующих языков:

**TypeScript и JavaScript:**
- TypeScript, TSX (TypeScript с JSX), JavaScript (с поддержкой JSX)
- JSDoc комментарии с подсветкой синтаксиса

**Веб-разработка:**
- HTML, CSS, SCSS, JSON, YAML, TOML

**React + TypeScript экосистема:**
- GraphQL, SQL, Dockerfile

**Дополнительные языки:**
- Java, XML, EditorConfig, Markdown
- Bash, Git (ignore, commit, diff), Regex, Lua

Парсеры устанавливаются автоматически при первом использовании соответствующего типа файла (асинхронно, без блокировки запуска Neovim).

Для ручной установки всех парсеров используйте:
```
:TSInstall all
```

Для установки конкретного парсера:
```
:TSInstall typescript
```

**Примечание:** Конфигурация использует `sync_install = false` для предотвращения синхронной установки парсеров при каждом запуске Neovim.

**Устранение проблем с подсветкой TypeScript:**
- Убедитесь, что парсеры установлены: `:TSInstall typescript tsx javascript`
- Проверьте статус парсеров: `:TSInstallInfo`
- Перезагрузите treesitter: `:TSBufEnable highlight`
- Если подсветка не работает, попробуйте обновить парсеры: `:TSUpdate typescript tsx javascript`

## Обновление плагинов

Проверка обновлений плагинов выполняется автоматически в фоновом режиме (раз в час) и не блокирует запуск Neovim.

Для ручного обновления используйте команду в Neovim:
```
:Lazy update
```

Для просмотра доступных обновлений:
```
:Lazy
```

## Дополнительная информация

- Конфигурация использует модульную структуру через `require()`
- Все настройки разделены по модулям для удобства поддержки
- Версии плагинов фиксируются в `lazy-lock.json`
